{"ast":null,"code":"import _regeneratorRuntime from\"/home/dh/Repositorio/appfood/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/dh/Repositorio/appfood/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/dh/Repositorio/appfood/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/dh/Repositorio/appfood/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import{useParams}from'react-router';import{useHistory}from'react-router-dom';import FavoriteButton from'../components/FavoriteButton';import RecipesAppContext from'../context/RecipesAppContext';import{getIngredient}from'../services/Functions';export default function BebidasEmProgresso(){var _useContext=useContext(RecipesAppContext),idDrinks=_useContext.idDrinks,setDrinkId=_useContext.setDrinkId,setInProgress=_useContext.setInProgress;var _useParams=useParams(),drinkId=_useParams.drinkId;setDrinkId(drinkId);var _idDrinks=_slicedToArray(idDrinks,1),drink=_idDrinks[0];var history=useHistory();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),checks=_useState2[0],setCheck=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),ingredientsUsed=_useState4[0],setIngredientsUsed=_useState4[1];useEffect(function(){var inProgress=JSON.parse(localStorage.getItem('inProgressRecipes'));if(inProgress&&inProgress.cocktails[drinkId]){setInProgress(inProgress);setIngredientsUsed(inProgress.cocktails[drinkId]);}},[drinkId,setInProgress]);useEffect(function(){var inProgress=JSON.parse(localStorage.getItem('inProgressRecipes'));if(inProgress){inProgress.cocktails[drinkId]=ingredientsUsed;setInProgress(inProgress);localStorage.setItem('inProgressRecipes',JSON.stringify(inProgress));}setCheck(ingredientsUsed.length);},[ingredientsUsed,drinkId,setInProgress]);var finishRecipe=function finishRecipe(){var doneRecipes=JSON.parse(localStorage.getItem('doneRecipes'));if(doneRecipes){doneRecipes.push({id:drinkId,type:'bebida',area:'',category:drink.strCategory,alcoholicOrNot:drink.strAlcoholic,name:drink.strDrink,image:drink.strDrinkThumb,tags:[]});}else{doneRecipes=[{id:drinkId,type:'bebida',area:'',category:drink.strCategory,alcoholicOrNot:drink.strAlcoholic,name:drink.strDrink,image:drink.strDrinkThumb,tags:[]}];}localStorage.setItem('doneRecipes',JSON.stringify(doneRecipes));history.push('/receitas-feitas');};return/*#__PURE__*/React.createElement(\"div\",null,drink&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{\"data-testid\":\"recipe-photo\",src:\"\".concat(drink.strDrinkThumb),alt:\"\",width:\"400\"}),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"recipe-title\"},drink.strDrink),/*#__PURE__*/React.createElement(\"p\",null,drink.strAlcoholic),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"recipe-category\"},drink.strCategory,drink.strAlcoholic),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"instructions\"},drink.strInstructions),getIngredient(drink).map(function(ingredient){return/*#__PURE__*/React.createElement(\"div\",{key:ingredient.nome},/*#__PURE__*/React.createElement(\"label\",{\"data-testid\":\"\".concat(ingredient.index-1,\"-ingredient-step\"),htmlFor:ingredient.nome,className:ingredientsUsed.includes(ingredient.index)?'stepDone':null},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",id:ingredient.nome,checked:ingredientsUsed.includes(ingredient.index),onChange:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var target,text,index;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:target=_ref.target;text=target.parentElement;text.classList.toggle('stepDone');if(target.checked){setIngredientsUsed([].concat(_toConsumableArray(ingredientsUsed),[ingredient.index]));}else{index=ingredientsUsed.indexOf(ingredient.index);ingredientsUsed.splice(index,1);setIngredientsUsed(_toConsumableArray(ingredientsUsed));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()}),\"\".concat(ingredient.nome,\" - \").concat(ingredient.quantidade)));}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",\"data-testid\":\"share-btn\",value:\"Compartilhar\"}),/*#__PURE__*/React.createElement(FavoriteButton,{id:drinkId,type:\"bebida\",recipe:drink}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",\"data-testid\":\"finish-recipe-btn\",value:\"Finalizar Receita\",disabled:checks!==getIngredient(drink).length,onClick:finishRecipe})));}","map":{"version":3,"sources":["/home/dh/Repositorio/appfood/AppFood/src/pages/BebidasEmProgresso.jsx"],"names":["React","useContext","useEffect","useState","useParams","useHistory","FavoriteButton","RecipesAppContext","getIngredient","BebidasEmProgresso","idDrinks","setDrinkId","setInProgress","drinkId","drink","history","checks","setCheck","ingredientsUsed","setIngredientsUsed","inProgress","JSON","parse","localStorage","getItem","cocktails","setItem","stringify","length","finishRecipe","doneRecipes","push","id","type","area","category","strCategory","alcoholicOrNot","strAlcoholic","name","strDrink","image","strDrinkThumb","tags","strInstructions","map","ingredient","nome","index","includes","target","text","parentElement","classList","toggle","checked","indexOf","splice","quantidade"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport { useHistory } from 'react-router-dom';\nimport FavoriteButton from '../components/FavoriteButton';\nimport RecipesAppContext from '../context/RecipesAppContext';\nimport { getIngredient } from '../services/Functions';\n\nexport default function BebidasEmProgresso() {\n  const { idDrinks, setDrinkId, setInProgress } = useContext(RecipesAppContext);\n  const { drinkId } = useParams();\n  setDrinkId(drinkId);\n  const [drink] = idDrinks;\n\n  const history = useHistory();\n  const [checks, setCheck] = useState(0);\n  const [ingredientsUsed, setIngredientsUsed] = useState([]);\n\n  useEffect(() => {\n    const inProgress = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if (inProgress && inProgress.cocktails[drinkId]) {\n      setInProgress(inProgress);\n      setIngredientsUsed(inProgress.cocktails[drinkId]);\n    }\n  }, [drinkId, setInProgress]);\n\n  useEffect(() => {\n    const inProgress = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if (inProgress) {\n      inProgress.cocktails[drinkId] = ingredientsUsed;\n      setInProgress(inProgress);\n      localStorage.setItem('inProgressRecipes', JSON.stringify(inProgress));\n    }\n    setCheck(ingredientsUsed.length);\n  }, [ingredientsUsed, drinkId, setInProgress]);\n\n  const finishRecipe = () => {\n    let doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n    if (doneRecipes) {\n      doneRecipes.push({\n        id: drinkId,\n        type: 'bebida',\n        area: '',\n        category: drink.strCategory,\n        alcoholicOrNot: drink.strAlcoholic,\n        name: drink.strDrink,\n        image: drink.strDrinkThumb,\n        tags: [],\n      });\n    } else {\n      doneRecipes = [{\n        id: drinkId,\n        type: 'bebida',\n        area: '',\n        category: drink.strCategory,\n        alcoholicOrNot: drink.strAlcoholic,\n        name: drink.strDrink,\n        image: drink.strDrinkThumb,\n        tags: [],\n      }];\n    }\n\n    localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    history.push('/receitas-feitas');\n  };\n\n  return (\n    <div>\n      { drink\n        && (\n          <div>\n            <img\n              data-testid=\"recipe-photo\"\n              src={ `${drink.strDrinkThumb}` }\n              alt=\"\"\n              width=\"400\"\n            />\n            <p data-testid=\"recipe-title\">{drink.strDrink}</p>\n            <p>{drink.strAlcoholic}</p>\n            <p data-testid=\"recipe-category\">\n              {drink.strCategory}\n              {drink.strAlcoholic}\n            </p>\n            <p data-testid=\"instructions\">{drink.strInstructions}</p>\n            { getIngredient(drink).map((ingredient) => (\n              <div key={ ingredient.nome }>\n                <label\n                  data-testid={ `${ingredient.index - 1}-ingredient-step` }\n                  htmlFor={ ingredient.nome }\n                  className={\n                    ingredientsUsed.includes(ingredient.index) ? 'stepDone' : null\n                  }\n                >\n                  <input\n                    type=\"checkbox\"\n                    id={ ingredient.nome }\n                    checked={ ingredientsUsed.includes(ingredient.index) }\n                    onChange={ async ({ target }) => {\n                      const text = target.parentElement;\n                      text.classList.toggle('stepDone');\n                      if (target.checked) {\n                        setIngredientsUsed([...ingredientsUsed, ingredient.index]);\n                      } else {\n                        const index = ingredientsUsed.indexOf(ingredient.index);\n                        ingredientsUsed.splice(index, 1);\n                        setIngredientsUsed([...ingredientsUsed]);\n                      }\n                    } }\n                  />\n                  {`${ingredient.nome} - ${ingredient.quantidade}`}\n                </label>\n              </div>\n            ))}\n\n            <input\n              type=\"button\"\n              data-testid=\"share-btn\"\n              value=\"Compartilhar\"\n            />\n            <FavoriteButton id={ drinkId } type=\"bebida\" recipe={ drink } />\n            <input\n              type=\"button\"\n              data-testid=\"finish-recipe-btn\"\n              value=\"Finalizar Receita\"\n              disabled={ (checks !== getIngredient(drink).length) }\n              onClick={ finishRecipe }\n            />\n          </div>)}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}