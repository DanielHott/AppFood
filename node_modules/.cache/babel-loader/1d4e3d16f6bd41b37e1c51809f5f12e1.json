{"ast":null,"code":"import _regeneratorRuntime from\"/home/dh/Repositorio/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/dh/Repositorio/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/dh/Repositorio/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/dh/Repositorio/AppFood/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from'react';import{useParams}from'react-router-dom';import{useHistory}from'react-router-dom/cjs/react-router-dom.min';import FavoriteButton from'../components/FavoriteButton';import RecipesAppContext from'../context/RecipesAppContext';import{getIngredient}from'../services/Functions';export default function ComidasEmProgresso(){var _useContext=useContext(RecipesAppContext),idDishes=_useContext.idDishes,setFoodId=_useContext.setFoodId,setInProgress=_useContext.setInProgress;var _useParams=useParams(),dishId=_useParams.dishId;setFoodId(dishId);var _idDishes=_slicedToArray(idDishes,1),dish=_idDishes[0];var history=useHistory();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),checks=_useState2[0],setCheck=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),ingredientsUsed=_useState4[0],setIngredientsUsed=_useState4[1];useEffect(function(){var inProgress=JSON.parse(localStorage.getItem('inProgressRecipes'));if(inProgress&&inProgress.meals[dishId]){setInProgress(inProgress);setIngredientsUsed(inProgress.meals[dishId]);}},[dishId,setInProgress]);useEffect(function(){var inProgress=JSON.parse(localStorage.getItem('inProgressRecipes'));if(inProgress){inProgress.meals[dishId]=ingredientsUsed;setInProgress(inProgress);localStorage.setItem('inProgressRecipes',JSON.stringify(inProgress));}setCheck(ingredientsUsed.length);},[ingredientsUsed,dishId,setInProgress]);var finishRecipe=function finishRecipe(){var doneRecipes=JSON.parse(localStorage.getItem('doneRecipes'));if(doneRecipes){doneRecipes.push({id:dishId,type:'comida',area:dish.strArea,category:dish.strCategory,alcoholicOrNot:'',name:dish.strMeal,image:dish.strMealThumb,tags:dish.strTags.split(',')});}else{doneRecipes=[{id:dishId,type:'comida',area:dish.strArea,category:dish.strCategory,alcoholicOrNot:'',name:dish.strMeal,image:dish.strMealThumb,tags:dish.strTags.split(',')}];}localStorage.setItem('doneRecipes',JSON.stringify(doneRecipes));history.push('/receitas-feitas');};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"In Progress\"),/*#__PURE__*/React.createElement(\"div\",{className:\"recipe-detail\"},dish&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{\"data-testid\":\"recipe-photo\",src:\"\".concat(dish.strMealThumb),alt:\"\",width:\"400\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"shot-instruction\"},/*#__PURE__*/React.createElement(\"h2\",{\"data-testid\":\"recipe-title\",id:\"title\"},dish.strMeal),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"recipe-category\"},dish.strCategory),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"instructions\"},dish.strInstructions)),/*#__PURE__*/React.createElement(\"div\",{id:\"checks\"},getIngredient(dish).map(function(ingredient){return/*#__PURE__*/React.createElement(\"div\",{key:ingredient.index},/*#__PURE__*/React.createElement(\"label\",{\"data-testid\":\"\".concat(ingredient.index-1,\"-ingredient-step\"),htmlFor:ingredient.nome,className:ingredientsUsed.includes(ingredient.index)?'stepDone':null},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",id:ingredient.nome,checked:ingredientsUsed.includes(ingredient.index),onChange:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var target,text,index;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:target=_ref.target;text=target.parentElement;text.classList.toggle('stepDone');if(target.checked){setIngredientsUsed([].concat(_toConsumableArray(ingredientsUsed),[ingredient.index]));}else{index=ingredientsUsed.indexOf(ingredient.index);ingredientsUsed.splice(index,1);setIngredientsUsed(_toConsumableArray(ingredientsUsed));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()}),\"\".concat(ingredient.nome,\" - \").concat(ingredient.quantidade)));})),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",\"data-testid\":\"share-btn\",value:\"Compartilhar\"}),/*#__PURE__*/React.createElement(FavoriteButton,{recipe:dish,type:\"comida\",id:dishId}),/*#__PURE__*/React.createElement(\"input\",{type:\"button\",\"data-testid\":\"finish-recipe-btn\",disabled:checks!==getIngredient(dish).length,onClick:finishRecipe,value:\"Finalizar-Receita\"}))));}","map":{"version":3,"sources":["/home/dh/Repositorio/AppFood/src/pages/ComidasEmProgresso.jsx"],"names":["React","useContext","useState","useEffect","useParams","useHistory","FavoriteButton","RecipesAppContext","getIngredient","ComidasEmProgresso","idDishes","setFoodId","setInProgress","dishId","dish","history","checks","setCheck","ingredientsUsed","setIngredientsUsed","inProgress","JSON","parse","localStorage","getItem","meals","setItem","stringify","length","finishRecipe","doneRecipes","push","id","type","area","strArea","category","strCategory","alcoholicOrNot","name","strMeal","image","strMealThumb","tags","strTags","split","strInstructions","map","ingredient","index","nome","includes","target","text","parentElement","classList","toggle","checked","indexOf","splice","quantidade"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\r\n\r\nimport { useParams } from 'react-router-dom';\r\nimport { useHistory } from 'react-router-dom/cjs/react-router-dom.min';\r\nimport FavoriteButton from '../components/FavoriteButton';\r\nimport RecipesAppContext from '../context/RecipesAppContext';\r\nimport { getIngredient } from '../services/Functions';\r\n\r\nexport default function ComidasEmProgresso() {\r\n  const {\r\n    idDishes,\r\n    setFoodId,\r\n    setInProgress,\r\n  } = useContext(RecipesAppContext);\r\n  const { dishId } = useParams();\r\n  setFoodId(dishId);\r\n  const [dish] = idDishes;\r\n\r\n  const history = useHistory();\r\n  const [checks, setCheck] = useState(0);\r\n  const [ingredientsUsed, setIngredientsUsed] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const inProgress = JSON.parse(localStorage.getItem('inProgressRecipes'));\r\n    if (inProgress && inProgress.meals[dishId]) {\r\n      setInProgress(inProgress);\r\n      setIngredientsUsed(inProgress.meals[dishId]);\r\n    }\r\n  }, [dishId, setInProgress]);\r\n\r\n  useEffect(() => {\r\n    const inProgress = JSON.parse(localStorage.getItem('inProgressRecipes'));\r\n    if (inProgress) {\r\n      inProgress.meals[dishId] = ingredientsUsed;\r\n      setInProgress(inProgress);\r\n      localStorage.setItem('inProgressRecipes', JSON.stringify(inProgress));\r\n    }\r\n    setCheck(ingredientsUsed.length);\r\n  }, [ingredientsUsed, dishId, setInProgress]);\r\n\r\n  const finishRecipe = () => {\r\n    let doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\r\n    if (doneRecipes) {\r\n      doneRecipes.push({\r\n        id: dishId,\r\n        type: 'comida',\r\n        area: dish.strArea,\r\n        category: dish.strCategory,\r\n        alcoholicOrNot: '',\r\n        name: dish.strMeal,\r\n        image: dish.strMealThumb,\r\n        tags: dish.strTags.split(','),\r\n      });\r\n    } else {\r\n      doneRecipes = [{\r\n        id: dishId,\r\n        type: 'comida',\r\n        area: dish.strArea,\r\n        category: dish.strCategory,\r\n        alcoholicOrNot: '',\r\n        name: dish.strMeal,\r\n        image: dish.strMealThumb,\r\n        tags: dish.strTags.split(','),\r\n      }];\r\n    }\r\n    localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\r\n    history.push('/receitas-feitas');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>In Progress</h2>\r\n      <div className=\"recipe-detail\">\r\n        {\r\n          dish && (\r\n            <div>\r\n              <img\r\n                data-testid=\"recipe-photo\"\r\n                src={ `${dish.strMealThumb}` }\r\n                alt=\"\"\r\n                width=\"400\"\r\n              />\r\n              <div className=\"shot-instruction\">\r\n                <h2 data-testid=\"recipe-title\" id=\"title\">{dish.strMeal}</h2>\r\n                <p data-testid=\"recipe-category\">{dish.strCategory}</p>\r\n                <p data-testid=\"instructions\">{dish.strInstructions}</p>\r\n              </div>\r\n              <div id=\"checks\">\r\n                { getIngredient(dish).map((ingredient) => (\r\n                  <div\r\n                    key={ ingredient.index }\r\n                  >\r\n                    <label\r\n                      data-testid={ `${ingredient.index - 1}-ingredient-step` }\r\n                      htmlFor={ ingredient.nome }\r\n                      className={\r\n                        ingredientsUsed.includes(ingredient.index) ? 'stepDone' : null\r\n                      }\r\n                    >\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        id={ ingredient.nome }\r\n                        checked={ ingredientsUsed.includes(ingredient.index) }\r\n                        onChange={ async ({ target }) => {\r\n                          const text = target.parentElement;\r\n                          text.classList.toggle('stepDone');\r\n                          if (target.checked) {\r\n                            setIngredientsUsed([...ingredientsUsed, ingredient.index]);\r\n                          } else {\r\n                            const index = ingredientsUsed.indexOf(ingredient.index);\r\n                            ingredientsUsed.splice(index, 1);\r\n                            setIngredientsUsed([...ingredientsUsed]);\r\n                          }\r\n                        } }\r\n                      />\r\n                      {`${ingredient.nome} - ${ingredient.quantidade}`}\r\n                    </label>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <input\r\n                type=\"button\"\r\n                data-testid=\"share-btn\"\r\n                value=\"Compartilhar\"\r\n              />\r\n              <FavoriteButton recipe={ dish } type=\"comida\" id={ dishId } />\r\n              <input\r\n                type=\"button\"\r\n                data-testid=\"finish-recipe-btn\"\r\n                disabled={ (checks !== getIngredient(dish).length) }\r\n                onClick={ finishRecipe }\r\n                value=\"Finalizar-Receita\"\r\n              />\r\n            </div>\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}